<div class="list-group">
  <div class="list-group-item list-group-item-action text-center py-4" *ngIf="noteData" (click)="addNote()">
    <span class="btn-link">
      <i class="fas fa-sticky-note mr-2"></i> Add Note
    </span>
  </div>
  <div class="text-center" *ngIf="(notes && !notes.length) || isUpdating; else results">
    <i class="fas fa-spinner fa-pulse d-inline-block"></i> Loading notes ...
  </div>
  <ng-template #results>
      <div class="list-group-item text-center text-danger" *ngIf="!notes?.length">
        <i class="far fa-sad-tear"></i> No notes
      </div>
      <div class="list-group-item" *ngFor="let note of notes">
        <div class="row">
          <div class="col-auto pr-0" *ngIf="note?.isPinned">
            <i class="fas fa-thumbtack fa-fw" tooltip="Pinned to top"></i>
          </div>
          <div class="col-auto" *ngIf="note?.isImportant">
            <i class="fas fa-exclamation-circle text-danger fa-fw" tooltip="Important"></i>
          </div>
          <div class="col text-right">
            <div class="btn-group" dropdown placement="bottom right">
              <button id="actionsToggle" dropdownToggle type="button" class="btn btn-link p-0 dropdown-toggle"
                aria-controls="actionsList">
                Actions <span class="caret"></span>
              </button>
              <ul id="actionsList" *dropdownMenu class="dropdown-menu dropdown-menu-right" role="menu"
                aria-labelledby="actionsToggle">
                <li role="menuitem">
                  <button type="button" class="dropdown-item" (click)="setFlag(note?.id, true)">
                    <i class="fas fa-exclamation-circle fa-fw text-danger"></i>
                    <i class="fas fa-times fa-xs align-text-top" *ngIf="note?.isImportant"></i>
                    <span class="ml-2">Set as
                      <ng-container *ngIf="note?.isImportant; else important ">unimportant</ng-container>
                      <ng-template #important>important</ng-template>
                    </span>
                  </button>
                </li>
                <li role="menuitem">
                  <button type="button" class="dropdown-item" (click)="setFlag(note?.id, false)">
                    <i class="fas fa-thumbtack fa-fw"></i>
                    <i class="fas fa-times fa-xs align-text-top" *ngIf="note?.isPinned"></i>
                    <span class="ml-2">
                      <ng-container *ngIf="note?.isPinned; else pin ">Unpin </ng-container>
                      <ng-template #pin>Pin to top</ng-template>
                    </span>
                  </button>
                </li>
              </ul>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-12">
            <div class="row">
              <div class="col-sm" *ngIf="note?.contactGroupId || note?.personId">
                <ng-container *ngIf="groupAddressee; else groupsInfo">
                  <ng-container *ngIf="note?.contactGroupId; else personNote">{{groupAddressee || note?.contactGroupId}}
                  </ng-container>
                  <ng-template #personNote>
                    <div *ngIf="contactPeople">
                      <div *ngFor="let person of contactPeople">
                        <div *ngIf="person.personId === note?.personId">{{person.addressee}}</div>
                      </div>
                    </div>
                  </ng-template>
                </ng-container>
                <ng-template #groupsInfo>
                  <div *ngIf="addressees && person">
                    <div *ngFor="let group of addressees">
                      <div *ngIf="group.groupId === note?.contactGroupId">{{group.addressee}}</div>
                    </div>
                    <div *ngIf="person.personId === note?.personId">{{person.addressee}}</div>
                  </div>
                </ng-template>
              </div>
              <div class="col-sm mb-2">
                {{note?.text}}
              </div>
              <div class="col-sm-3 text-muted">
                {{note?.createdBy}}<br>
                {{note?.createDate | date: 'HH:mm d/MM/yyyy'}}
              </div>
            </div>
          </div>
        </div>
      </div>
  </ng-template>
</div>
