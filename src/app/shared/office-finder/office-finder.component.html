<form [formGroup]="officeFinderForm">
  <fieldset [ngClass]="{'invalid': isRequired}">
    <label for="office">Office</label>
    <ng-container *ngIf="isMultiSelect;else dropDown">
      <p-multiSelect [options]="offices$ |async" formControlName="officeIds" optionLabel="name" optionValue="officeId"
        display="chip" placeholder="Select Office(s)" (onChange)="onOfficeIdsSelected($event)"></p-multiSelect>
    </ng-container>

    <ng-template #dropDown>
      <p-dropdown [options]="offices$ |async" formControlName="officeId" optionLabel="name" optionValue="officeId"
        [showClear]="!readOnly" placeholder="Select Office" [filter]="true" filterBy="name" [readonly]="readOnly"
        (onChange)="onOfficeChange($event)" [ngClass]="{'no-style': readOnly}" data-cy="office">
      </p-dropdown>
    </ng-template>
    <p class="message message--negative">Office is required</p>
  </fieldset>
</form>
