<div class="row">
  <div class="mb-10 md:mb-0 row__item row__item--aside">
    <div class="wrapper--sticky">
      <app-contact-group-card
        class="appWrapper"
        [(adminContact)]="adminContact"
        [contactGroup]="adminContactGroup ? adminContactGroup : contactGroup"
        *ngIf="contactGroup"
      ></app-contact-group-card>
      <div>
        <app-sidenav-item
          class="appWrapper"
          [sideNavItems]="sideNavItems"
          [summaryTotals]="summaryTotals"
          (selectedItem)="getSelectedSideNavItem($event)"
        ></app-sidenav-item>
        <div class="card" *ngIf="property">
          <div class="card__header">
            Status
            <span
              class="pill flexRight"
              [ngClass]="{
                'pill--negative': valuation.valuationStatus == 5,
                'pill--positive': valuation.valuationStatus != 5
              }"
            >
              {{ valuation?.valuationStatusDescription }}
            </span>
          </div>
          <div class="card__body">
            <ol>
              <li *ngFor="let item of statuses">
                <div class="flex flex-row">
                  <div
                    class="flex items-center w-4 h-4 mr-2 text-center rounded-full"
                    [ngClass]="{ 'opacity-75 bg-gray-500': !item.isValid, 'bg-green-600': item.isValid }"
                  >
                    <i *ngIf="item.isValid" class="ml-0.3 text-white pi pi-check"></i>
                  </div>
                  <a (click)="toggleAccordion(item.value)">{{ item?.name | toPascalCase }}</a>
                </div>
              </li>
            </ol>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div #mainRowItem class="w-screen row__item">
    <div class="wrapper--sticky wrapper--stickyTop">
      <div *ngIf="!isNoteSelected" class="row__item">
        <div class="wrapper--redacted" *ngIf="!property">
          <button class="btn btn--redacted btn--positive" (click)="showProperty = true">
            <svg aria-hidden="true" width="64" height="64" viewBox="0 0 64 64" class="icon icon--onLeft">
              <path
                class="horizontal"
                d="M61 28H3c-1.7 0-3 1.8-3 3.5v1.1C0 34.2 1.3 36 3 36h58c1.7 0 3-1.8 3-3.5v-1C64 29.8 62.7 28 61 28z"
              ></path>
              <path
                class="vertical"
                d="M36 61V3c0-1.7-1.8-3-3.5-3l-1.1 0C29.8 0 28 1.3 28 3v58c0 1.7 1.8 3 3.5 3h1C34.2 64 36 62.7 36 61z"
              ></path>
            </svg>
            New Property
          </button>
          <div class="card card--horizontal">
            <div class="card__headerImg">
              <span class="redacted redacted--title redacted--30pc"></span>
              <span class="redacted redacted--50pc"></span>
            </div>
            <div class="card__body">
              <ol class="list list--split">
                <li>
                  <ol class="list">
                    <li>
                      <svg
                        aria-hidden="true"
                        width="64"
                        height="64"
                        viewBox="0 0 64 64"
                        class="icon icon--s icon--onLeft"
                      >
                        <path
                          d="M56 24c0 17.5-20.3 38-21.2 38.8C34 63.6 33 64 32 64c-1 0-2-0.4-2.8-1.2C28.3 62 8 41.5 8 24 8 10.8 18.8 0 32 0S56 10.8 56 24zM32 36c6.6 0 12-5.4 12-12 0-6.6-5.4-12-12-12s-12 5.4-12 12C20 30.6 25.4 36 32 36z"
                        ></path>
                      </svg>
                      <span class="redacted redacted--100pc"></span>
                      <span class="redacted redacted--100pc"></span>
                    </li>
                    <li>
                      <svg
                        aria-hidden="true"
                        width="64"
                        height="64"
                        viewBox="0 0 64 64"
                        class="icon icon--s icon--onLeft"
                      >
                        <path
                          d="M61.3 1c-0.2 0-0.4 0-0.5 0.1L42.3 8.2 21.7 1 2.3 7.5C1.5 7.8 1 8.4 1 9.2v52.1C1 62.2 1.8 63 2.7 63c0.2 0 0.4 0 0.5-0.1l18.4-7.1L42.3 63l19.4-6.5c0.7-0.3 1.2-0.9 1.2-1.7V2.7C63 1.8 62.2 1 61.3 1zM42.3 56.1l-20.7-7.3v-41l20.7 7.3V56.1z"
                        ></path>
                      </svg>
                      <span class="redacted redacted--50pc"></span>
                    </li>
                    <li>
                      <svg
                        aria-hidden="true"
                        width="24"
                        height="24"
                        viewBox="0 0 24 24"
                        class="icon icon--s icon--onLeft"
                      >
                        <path d="M0 0h24v24H0z" fill="none"></path>
                        <path
                          d="M22 16V4c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2zm-11-4l2.03 2.71L16 11l4 5H8l3-4zM2 6v14c0 1.1.9 2 2 2h14v-2H4V6H2z"
                        ></path>
                      </svg>
                      <span class="redacted redacted--20pc"></span>
                    </li>
                    <li class="hideLabel">
                      <svg
                        aria-hidden="true"
                        width="64"
                        height="64"
                        viewBox="0 0 64 64"
                        class="icon icon--s icon--onLeft"
                      >
                        <path
                          d="M32 16.5V4.1H1v55.8h62V16.5H32zM13.4 53.7H7.2v-6.2h6.2V53.7zM13.4 41.3H7.2v-6.2h6.2V41.3zM13.4 28.9H7.2v-6.2h6.2V28.9zM13.4 16.5H7.2v-6.2h6.2V16.5zM25.8 53.7h-6.2v-6.2h6.2V53.7zM25.8 41.3h-6.2v-6.2h6.2V41.3zM25.8 28.9h-6.2v-6.2h6.2V28.9zM25.8 16.5h-6.2v-6.2h6.2V16.5zM56.8 53.7H32v-6.2h6.2v-6.2H32v-6.2h6.2v-6.2H32v-6.2h24.8V53.7zM50.6 28.9h-6.2v6.2h6.2V28.9zM50.6 41.3h-6.2v6.2h6.2V41.3z"
                        ></path>
                      </svg>
                      <span class="redacted redacted--50pc"></span>
                    </li>
                    <li>
                      <svg
                        aria-hidden="true"
                        width="64"
                        height="64"
                        viewBox="0 0 64 64"
                        class="icon icon--s icon--onLeft"
                      >
                        <path
                          d="M32 0L0 36.1h8V64h6.8v-4.3c0-5.7 11.5-8.6 17.2-8.6s17.2 2.8 17.2 8.5V64H56V36.1h8L32 0zM32 46.8c-4.8 0-8.6-3.9-8.6-8.6 0-4.8 3.8-8.6 8.6-8.6s8.6 3.8 8.6 8.6C40.6 42.9 36.8 46.8 32 46.8z"
                        ></path>
                      </svg>
                      <span class="redacted redacted--10pc"></span>
                      <span class="redacted redacted--50pc"></span>
                    </li>
                  </ol>
                </li>
                <li class="expandable">
                  <details open="">
                    <summary>
                      <div class="summary__title">
                        Additional details
                        <svg
                          aria-hidden="true"
                          width="64"
                          height="64"
                          viewBox="0 0 64 64"
                          class="icon icon--s flexRight"
                        >
                          <path
                            d="M61 28H3c-1.7 0-3 1.8-3 3.5v1.1C0 34.2 1.3 36 3 36h58c1.7 0 3-1.8 3-3.5v-1C64 29.8 62.7 28 61 28z"
                            class="vertical"
                          ></path>
                          <path
                            d="M36 61V3c0-1.7-1.8-3-3.5-3l-1.1 0C29.8 0 28 1.3 28 3v58c0 1.7 1.8 3 3.5 3h1C34.2 64 36 62.7 36 61z"
                            class="horizontal"
                          ></path>
                        </svg>
                      </div>
                    </summary>
                    <ol class="list">
                      <li>
                        <span class="redacted redacted--title redacted--30pc"></span>
                        <span class="redacted redacted--50pc"></span>
                      </li>
                      <li>
                        <span class="redacted redacted--title redacted--20pc"></span>
                        <span class="redacted redacted--50pc"></span>
                      </li>
                      <li>
                        <span class="redacted redacted--title redacted--40pc"></span>
                        <span class="redacted redacted--50pc"></span>
                      </li>
                      <li>
                        <span class="redacted redacted--title redacted--10pc"></span>
                        <span class="redacted redacted--50pc"></span>
                      </li>
                      <li>
                        <span class="redacted redacted--title redacted--50pc"></span>
                        <span class="redacted redacted--50pc"></span>
                      </li>
                    </ol>
                  </details>
                </li>
              </ol>
            </div>
          </div>
        </div>
        <div *ngIf="isCancelled && property">
          <p-messages severity="error">
            <ng-template pTemplate>
              <div data-cy="cancelMessage" class="p-ml-2">
                <h1>{{ cancelString }}</h1>
                <p class="opacity-60">{{ cancelReasonString }}</p>
              </div>
            </ng-template>
          </p-messages>
        </div>
        <div class="mr-8 md:m-0" [ngClass]="{'opacity-75 pointer-events-none': isCancelled || isPropertyInfoDisabled}"
          (click)="controlIsCancelled($event,(isCancelled || isPropertyInfoDisabled));">
          <app-property-card class="appWrapper" [propertyDetails]="property" [isHorizontalCard]="true"
            [showPropertyDetailActions]="false" [showValuationActions]="true"
            [showActionButtons]="valuation?.valuationStatus == 0 || valuation?.valuationStatus == 2?true:false"
            (showPhotos)="showPhotosModal()" (showMap)="showMapModal()" (changeProperty)="changeProperty()"
            (changeLastknownOwner)="sharedService.addLastOwnerBs.next(true);isLastKnownOwnerVisible = true">
          </app-property-card>
        </div>

        <form [formGroup]="valuationForm" autocompleteOff>
          <ng-container *ngIf="property">
            <p-accordion [multiple]="true">
              <div class="mr-8 md:m-0">
                <p-accordionTab
                  header="Valuation Notes"
                  [(selected)]="activeState[0]"
                  *ngIf="
                    isEditable ||
                    isNewValuation ||
                    isStillInOneMonthPeriod ||
                    (!isEditable && valuationForm.get('reason').value) ||
                    (!isEditable && valuationForm.get('timeFrame').value) ||
                    (!isEditable && valuationForm.get('generalNotes').value)
                  "
                >
                  <div
                    id="valuationNotesTab"
                    class="grid grid--9"
                    [ngClass]="{ 'opacity-75 pointer-events-none': isCancelled }"
                    (click)="controlIsCancelled($event, isCancelled)"
                  >
                    <div>
                      <fieldset
                        class="mb-3 inline-child"
                        [ngClass]="{ invalid: formErrors?.reason }"
                        *ngIf="isEditable || isNewValuation || (!isEditable && valuationForm.get('reason').value)"
                      >
                        <label for="reason">Whatâ€™s the current situation?</label>
                        <textarea
                          class="p-2"
                          name="reason"
                          id="reason"
                          cols="30"
                          rows="3"
                          formControlName="reason"
                          data-cy="reason"
                          [ngClass]="{ 'is-invalid': formErrors?.reason }"
                        ></textarea>
                        <p class="message message--negative">{{ formErrors?.reason }}</p>
                      </fieldset>
                    </div>

                    <div>
                      <fieldset
                        class="mb-3 inline-child"
                        [ngClass]="{ invalid: formErrors?.timeFrame }"
                        *ngIf="isEditable || isNewValuation || (!isEditable && valuationForm.get('timeFrame').value)"
                      >
                        <label for="timeFrame">When are you looking to market?</label>
                        <textarea
                          class="p-2"
                          name="timeFrame"
                          id="timeFrame"
                          cols="30"
                          rows="3"
                          formControlName="timeFrame"
                          data-cy="timeFrame"
                          [ngClass]="{ 'is-invalid': formErrors?.timeFrame }"
                        ></textarea>
                        <p class="message message--negative">{{ formErrors?.timeFrame }}</p>
                      </fieldset>
                    </div>

                    <div>
                      <fieldset
                        class="mb-3 inline-child"
                        [ngClass]="{ invalid: formErrors?.generalNotes }"
                        *ngIf="isEditable || isNewValuation || (!isEditable && valuationForm.get('generalNotes').value)"
                      >
                        <label for="generalNotes">Notes (points discussed, other property details)</label>
                        <textarea
                          class="p-2"
                          name="generalNotes"
                          id="generalNotes"
                          cols="30"
                          rows="3"
                          formControlName="generalNotes"
                          data-cy="generalNotes"
                          [ngClass]="{ 'is-invalid': formErrors?.generalNotes }"
                        ></textarea>
                        <p class="message message--negative">{{ formErrors?.generalNotes }}</p>
                      </fieldset>
                    </div>
                  </div>
                </p-accordionTab>

                <p-accordionTab header="Property Info" [(selected)]="activeState[1]">
                  <div
                    id="propertyInfoTab"
                    [ngClass]="{ 'opacity-75 pointer-events-none': isCancelled }"
                    (click)="controlIsCancelled($event, isCancelled)"
                  >
                    <div class="inline-parent inline-parent__hasLabels">
                      <fieldset class="inline-child" [ngClass]="{ invalid: formErrors?.propertyTypeId }">
                        <label for="propertyTypeId">Property Type</label>
                        <p-dropdown
                          name="propertyTypeId"
                          id="propertyTypeId"
                          [options]="propertyTypes"
                          formControlName="propertyTypeId"
                          optionLabel="value"
                          optionValue="id"
                          [filter]="false"
                          data-cy="propertyTypeId"
                        ></p-dropdown>
                        <p class="message message--negative">{{ formErrors?.propertyTypeId }}</p>
                      </fieldset>
                      <fieldset class="inline-child" [ngClass]="{ invalid: formErrors?.propertyStyleId }">
                        <label for="propertyStyleId">Property Style</label>
                        <p-dropdown
                          name="propertyStyleId"
                          id="propertyStyleId"
                          [options]="propertyStyles"
                          formControlName="propertyStyleId"
                          optionLabel="value"
                          optionValue="id"
                          [filter]="false"
                          data-cy="propertyStyleId"
                        ></p-dropdown>
                        <p class="message message--negative">{{ formErrors?.propertyStyleId }}</p>
                      </fieldset>
                      <fieldset class="inline-child" *ngIf="valuationForm.get('propertyTypeId').value == 2">
                        <label for="propertyFloorId">Floor</label>
                        <p-dropdown
                          name="propertyFloorId"
                          id="propertyFloorId"
                          [options]="propertyFloors"
                          formControlName="propertyFloorId"
                          optionLabel="value"
                          optionValue="id"
                          [filter]="false"
                          data-cy="propertyFloorId"
                        ></p-dropdown>
                      </fieldset>
                      <fieldset
                        class="inline-child"
                        *ngIf="
                          valuationForm.get('propertyTypeId').value == 2 &&
                          valuationForm.get('propertyFloorId').value == '10'
                        "
                        [ngClass]="{ invalid: formErrors?.floorOther }"
                      >
                        <label for="floorOther">Other</label>
                        <input
                          class="px-2"
                          type="text"
                          name="floorOther"
                          id="floorOther"
                          formControlName="floorOther"
                          [ngClass]="{ 'is-invalid': formErrors?.floorOther }"
                        />
                        <p class="message message--negative">{{ formErrors?.floorOther }}</p>
                      </fieldset>
                    </div>

                    <div class="inline-parent inline-parent__hasLabels">
                      <fieldset class="pb-2 pr-6">
                        <span class="checkbox">
                          <span>
                            <input class="p-2" type="checkbox" id="isNewBuild" name="isNewBuild"
                              formControlName="isNewBuild" data-cy="isNewBuild">
                            <label style="font-weight: bolder;" class="mb-1" for="isNewBuild">New Build</label>
                          </span>
                        </span>
                      </fieldset>
                      <fieldset class="pb-2">
                        <span class="checkbox">
                          <span>
                            <input class="p-2" type="checkbox" id="isRetirementHome" name="isRetirementHome"
                              formControlName="isRetirementHome" data-cy="isRetirementHome">
                            <label style="font-weight: bolder;" class="mb-1" for="isRetirementHome">Retirement
                              Home</label>
                          </span>
                        </span>
                      </fieldset>
                    </div>

                    <div class="inline-parent inline-parent__hasLabels">
                      <fieldset class="inline-child">
                        <label for="bedrooms">
                          <svg aria-hidden="true" width="64" height="64" viewBox="0 0 64 64" class="icon icon--onLeft">
                            <path
                              d="M17.9 33.4c4.7 0 8.5-3.8 8.5-8.5s-3.8-8.5-8.5-8.5S9.5 20.3 9.5 25 13.2 33.4 17.9 33.4zM51.7 16.5H29.2v19.7H6.6V10.9H1v42.3h5.6v-8.5h50.7v8.5H63V27.8C63 21.5 58 16.5 51.7 16.5z"
                            />
                          </svg>
                          Bedrooms
                        </label>
                        <span>
                          <input
                            class="p-2"
                            style="margin-top: 0px"
                            type="number"
                            name="bedrooms"
                            id="bedrooms"
                            formControlName="bedrooms"
                            min="0"
                            max="99"
                            [ngClass]="{ 'is-invalid': formErrors?.bedrooms }"
                            *ngIf="!showStudioLabel"
                            (blur)="studioLabelCheck($event.target.value)"
                          />
                          <input
                            class="p-2"
                            style="margin-top: 0px"
                            type="text"
                            name="studio"
                            *ngIf="
                              (!valuationForm.get('bedrooms').value || valuationForm.get('bedrooms').value == 0) &&
                              showStudioLabel
                            "
                            value="Studio"
                            (focus)="showStudioLabel = !showStudioLabel"
                          />
                          {{ formErrors?.bedrooms }}
                        </span>
                      </fieldset>

                      <fieldset class="inline-child">
                        <label for="bathrooms">
                          <svg aria-hidden="true" width="64" height="64" viewBox="0 0 64 64" class="icon icon--onLeft">
                            <circle cx="16.5" cy="16.5" r="6.2" />
                            <path
                              d="M56.8 35.1V9.8C56.8 4.9 52.9 1 48 1c-2.3 0-4.6 0.9-6.2 2.6L38 7.4c-0.5-0.2-1-0.2-1.6-0.2 -1.2 0-2.4 0.4-3.3 1l8.6 8.6c0.6-1 1-2.1 1-3.3 0-0.6-0.1-1.1-0.2-1.6l3.9-3.9c0.5-0.5 1.1-0.7 1.8-0.7 1.4 0 2.6 1.1 2.6 2.6v25.3H29.4c-0.9-0.7-1.8-1.4-2.5-2.2l-4.3-4.8c-0.6-0.7-1.3-1.2-2.1-1.5 -1-0.5-2-0.7-3.1-0.7 -3.8 0-6.9 3.1-6.9 7v2.3H1v18.6c0 3.4 2.8 6.2 6.2 6.2 0 1.7 1.4 3.1 3.1 3.1h43.4c1.7 0 3.1-1.4 3.1-3.1 3.4 0 6.2-2.8 6.2-6.2V35.1H56.8z"
                            />
                          </svg>
                          Bathrooms
                        </label>
                        <input
                          class="p-2"
                          type="number"
                          name="bathrooms"
                          id="bathrooms"
                          formControlName="bathrooms"
                          min="0"
                          max="99"
                          [ngClass]="{ 'is-invalid': formErrors?.bathrooms }"
                        />
                        {{ formErrors?.bathrooms }}
                      </fieldset>

                      <fieldset class="inline-child">
                        <label for="receptions">
                          <svg aria-hidden="true" width="64" height="64" viewBox="0 0 64 64" class="icon icon--onLeft">
                            <path
                              d="M58.2 26.2c-3.2 0-5.8 2.6-5.8 5.8v8.7H11.6V32c0-3.2-2.6-5.8-5.8-5.8S0 28.8 0 32v14.5c0 3.2 2.6 5.8 5.8 5.8h52.4c3.2 0 5.8-2.6 5.8-5.8V32C64 28.8 61.4 26.2 58.2 26.2zM49.5 11.6h-35c-3.2 0-5.8 2.6-5.8 5.8v6.3c3.4 1.2 5.8 4.4 5.8 8.2v5.9h34.9v-5.9c0-3.8 2.4-7 5.8-8.2v-6.3C55.3 14.3 52.7 11.6 49.5 11.6z"
                            />
                          </svg>
                          Receptions
                        </label>
                        <input
                          class="p-2"
                          type="number"
                          name="receptions"
                          id="receptions"
                          formControlName="receptions"
                          min="0"
                          max="99"
                          [ngClass]="{ 'is-invalid': formErrors?.receptions }"
                        />
                        {{ formErrors?.receptions }}
                      </fieldset>

                      <fieldset class="inline-child">
                        <label for="sqFt">
                          <svg aria-hidden="true" width="64" height="64" viewBox="0 0 64 64" class="icon icon--onLeft">
                            <path
                              d="M53.9 53.9L49.8 58l-2.8-2.8 4.1-4.1 -7.5-7.5 -4.1 4.1L36.8 45l4.1-4.1 -7.5-7.5 -4.1 4.1 -2.8-2.8 4.1-4.1 -7.6-7.6L19 27.2l-2.8-2.8 4.1-4.1 -7.5-7.5 -4.1 4.1L6 14.2l4.1-4.1L1 1v54.2C1 59.5 4.5 63 8.8 63H63L53.9 53.9zM12.6 51.4V29.1l22.3 22.3H12.6z"
                            />
                          </svg>
                          Approx sq. ft
                        </label>
                        <input class="p-2" type="text" name="sqFt" id="sqFt" formControlName="sqFt" />
                      </fieldset>
                    </div>

                    <div class="inline-parent inline-parent__hasLabels">
                      <fieldset class="inline-child">
                        <label for="tenureId">Tenure</label>
                        <p-dropdown
                          name="tenureId"
                          id="tenureId"
                          [options]="tenures"
                          formControlName="tenureId"
                          optionLabel="value"
                          optionValue="id"
                          [filter]="false"
                          data-cy="tenureId"
                          (onChange)="onTenureChange($event.value)"
                        ></p-dropdown>
                      </fieldset>
                      <fieldset
                        class="inline-child"
                        *ngIf="showLeaseExpiryDate"
                        [ngClass]="{ invalid: formErrors?.approxLeaseExpiryDate }"
                      >
                        <input
                          class="p-2"
                          [style]="{ height: '1.5em' }"
                          type="number"
                          name="approxLeaseExpiryDate"
                          autocomplete="off"
                          id="approxLeaseExpiryDate"
                          formControlName="approxLeaseExpiryDate"
                          placeholder="Approx Lease Length"
                        />
                        <p class="message message--negative">{{ formErrors?.approxLeaseExpiryDate }}</p>
                      </fieldset>
                    </div>

                    <fieldset
                      class="mb-3"
                      *ngIf="isEditable || isNewValuation || (!isEditable && valuationForm.get('outsideSpace').value)"
                    >
                      <label for="outsideSpace">Outside Space</label>
                      <p-multiSelect
                        [options]="outsideSpaces"
                        formControlName="outsideSpace"
                        optionLabel="value"
                        display="chip"
                      ></p-multiSelect>
                    </fieldset>

                    <fieldset
                      class="mb-3"
                      *ngIf="isEditable || isNewValuation || (!isEditable && valuationForm.get('parking').value)"
                    >
                      <label for="parking">Parking</label>
                      <p-multiSelect
                        [options]="parkings"
                        formControlName="parking"
                        optionLabel="value"
                        display="chip"
                      ></p-multiSelect>
                    </fieldset>

                    <fieldset class="pb-4 checkbox">
                      <span>
                        <input class="p-2" type="checkbox" id="hasDisabledAccess" name="hasDisabledAccess"
                          formControlName="hasDisabledAccess" data-cy="hasDisabledAccess">
                        <label style="font-weight: bolder;" for="hasDisabledAccess" class="mb-1">Disabled Access</label>
                      </span>
                    </fieldset>
                  </div>
                </p-accordionTab>

                <p-accordionTab header="Appointment" [(selected)]="activeState[2]">
                  <div
                    id="appointmentTab"
                    [ngClass]="{ 'opacity-75 pointer-events-none': isCancelled }"
                    (click)="controlIsCancelled($event, isCancelled)"
                  >
                    <fieldset *ngIf="isNewValuation && canBookAppointment">
                      <button
                        class="btn btn--positive"
                        type="button"
                        (click)="isBothEdit = true; getAvailability()"
                        data-cy="getvailability"
                      >
                        Book Availability
                      </button>
                    </fieldset>

                    <p-messages *ngIf="isAvailabilityRequired" severity="warn">
                      <ng-template pTemplate>
                        <div data-cy="availabilityMessage" class="p-ml-2">Please book availability before saving</div>
                      </ng-template>
                    </p-messages>

                    <div
                      class="inline-parent inline-parent__hasLabels"
                      *ngIf="salesValuerControl.value || lettingsValuerControl.value"
                    >
                      <fieldset
                        class="inline-child"
                        *ngIf="valuation?.salesValuationBooking"
                        style="align-self: flex-start"
                      >
                        <p-card class="mb-4 w-80 md:w-96">
                          <fieldset>
                            <label for="lettingsValuer">Sales Valuer</label>
                            <input
                              class="p-2"
                              type="text"
                              id="lettingsValuer"
                              disabled
                              [value]="salesValuerControl.value?.fullName"
                            />
                          </fieldset>
                          <span class="flex flex-col md:flex-row inline-parent">
                            <fieldset class="inline-child">
                              <label for="dateTime">Date & Time</label>
                              <input
                                class="p-2"
                                type="text"
                                id="dateTime"
                                disabled
                                value="{{
                                  valuation?.salesValuationBooking?.startDateTime | date: 'E d MMM yyyy, HH:mm'
                                }}"
                              />
                            </fieldset>
                            <fieldset class="inline-child">
                              <label for="duration">Duration</label>
                              <input
                                class="p-2"
                                type="text"
                                id="duration"
                                disabled
                                value="{{ valuationForm.get('totalHours').value + ' Hour' }}"
                              />
                            </fieldset>
                          </span>
                          <fieldset *ngIf="isEditable || isNewValuation">
                            <button
                              type="button"
                              class="btn btn--positive"
                              (click)="
                                isBothEdit = false;
                                isLettingsEdit = false;
                                isSalesEdit = true;
                                isSalesOnly = true;
                                getAvailability()
                              "
                              data-cy="openAvailabilitySales"
                            >
                              Edit
                            </button>
                          </fieldset>
                          <ng-template pTemplate="footer">
                            <div *ngIf="getTimeSalesValuationDate !== getTimeLettingsValuationDate">
                              <fieldset [attr.disabled]="!(isNewValuation && canBookAppointment)">
                                <label>Are we meeting the Owner ?</label>
                                <span class="radio radio--inline">
                                  <span>
                                    <input
                                      class="p-2"
                                      type="radio"
                                      id="salesMeetingOwnerYes"
                                      [value]="true"
                                      name="salesMeetingOwner"
                                      formControlName="salesMeetingOwner"
                                      data-cy="salesMeetingOwner"
                                    />
                                    <label for="salesMeetingOwnerYes">Yes</label>
                                  </span>
                                  <span>
                                    <input
                                      class="p-2"
                                      type="radio"
                                      id="salesMeetingOwnerNo"
                                      [value]="false"
                                      name="salesMeetingOwner"
                                      formControlName="salesMeetingOwner"
                                    />
                                    <label for="salesMeetingOwnerNo">No</label>
                                  </span>
                                </span>
                              </fieldset>
                              <div *ngIf="valuationForm.get('salesMeetingOwner').value === false">
                                <span class="inline-parent inline-parent__hasLabels">
                                  <fieldset
                                    class="inline-child"
                                    [ngClass]="{ invalid: formErrors?.salesOwnerAssociateName }"
                                  >
                                    <label for="salesOwnerAssociateName">Name</label>
                                    <input
                                      class="p-2"
                                      type="text"
                                      name="salesOwnerAssociateName"
                                      id="salesOwnerAssociateName"
                                      formControlName="salesOwnerAssociateName"
                                      [ngClass]="{ 'is-invalid': formErrors.salesOwnerAssociateName }"
                                    />
                                    <p class="message message--negative">{{ formErrors?.salesOwnerAssociateName }}</p>
                                  </fieldset>
                                  <fieldset
                                    class="inline-child"
                                    [ngClass]="{ invalid: formErrors?.salesOwnerAssociateContactNumber }"
                                  >
                                    <label for="salesOwnerAssociateContactNumber">Contact Number</label>
                                    <input
                                      class="p-2"
                                      type="text"
                                      pattern="[0-9*#+]+$"
                                      name="salesOwnerAssociateContactNumber"
                                      id="salesOwnerAssociateContactNumber"
                                      formControlName="salesOwnerAssociateContactNumber"
                                      [ngClass]="{ 'is-invalid': formErrors.salesOwnerAssociateContactNumber }"
                                    />
                                    <p class="message message--negative">
                                      {{ formErrors?.salesOwnerAssociateContactNumber }}
                                    </p>
                                  </fieldset>
                                </span>
                                <span class="inline-parent inline-parent__hasLabels">
                                  <fieldset
                                    class="inline-child"
                                    [ngClass]="{ invalid: formErrors?.salesOwnerAssociateEmail }"
                                  >
                                    <label for="salesOwnerAssociateEmail">Email Address</label>
                                    <input
                                      class="p-2"
                                      type="email"
                                      name="salesOwnerAssociateEmail"
                                      id="salesOwnerAssociateEmail"
                                      formControlName="salesOwnerAssociateEmail"
                                      [ngClass]="{ 'is-invalid': formErrors.salesOwnerAssociateEmail }"
                                    />
                                    <p class="message message--negative">{{ formErrors?.salesOwnerAssociateEmail }}</p>
                                  </fieldset>

                                  <fieldset class="inline-child">
                                    <label for="salesOwnerAssociateType">Association</label>
                                    <span class="select">
                                      <select id="salesOwnerAssociateType" formControlName="salesOwnerAssociateType">
                                        <option
                                          selected
                                          *ngFor="let associateType of associateTypes"
                                          [value]="associateType?.id"
                                        >
                                          {{ associateType?.value }}
                                        </option>
                                      </select>
                                    </span>
                                    <p class="message message--negative">{{ formErrors?.salesOwnerAssociateType }}</p>
                                  </fieldset>
                                </span>
                              </div>
                            </div>
                          </ng-template>
                        </p-card>
                      </fieldset>

                      <fieldset class="flex self-center justify-center mb-3 md:mb-8 inline-child"
                        *ngIf="(valuation?.valuationStatus == 0 || valuation?.valuationStatus == 2)">
                        <button [style]="{'width': '5rem'}" type="button" class="btn btn--positive"
                          (click)="isSalesEdit =false;isLettingsEdit = false;isBothEdit =true;getAvailability()"
                          data-cy="openAvailabilityBoth">{{valuation?.lettingsValuationBooking &&
                          valuation?.salesValuationBooking ? 'Edit Both' :
                          (valuation?.salesValuationBooking? 'Add Lettings':'Add Sales')}}
                        </button>
                      </fieldset>

                      <fieldset
                        class="inline-child"
                        *ngIf="valuation?.lettingsValuationBooking"
                        style="align-self: flex-start"
                      >
                        <p-card class="mb-4 w-80 md:w-96">
                          <fieldset>
                            <label for="lettingsValuer">Lettings Valuer</label>
                            <input
                              class="p-2"
                              type="text"
                              id="lettingsValuer"
                              disabled
                              [value]="lettingsValuerControl.value?.fullName"
                            />
                          </fieldset>
                          <span class="inline-parent">
                            <fieldset class="inline-child">
                              <label for="dateTime">Date & Time</label>
                              <input
                                class="p-2"
                                type="text"
                                id="dateTime"
                                disabled
                                value="{{
                                  valuation?.lettingsValuationBooking?.startDateTime | date: 'E d MMM yyyy, HH:mm'
                                }}"
                              />
                            </fieldset>
                            <fieldset class="inline-child">
                              <label for="duration">Duration</label>
                              <input
                                class="p-2"
                                type="text"
                                id="duration"
                                disabled
                                value="{{ valuationForm.get('totalHours').value + ' Hour' }}"
                              />
                            </fieldset>
                          </span>
                          <fieldset *ngIf="isEditable || isNewValuation">
                            <button
                              type="button"
                              class="btn btn--positive"
                              (click)="
                                isBothEdit = false;
                                isSalesEdit = false;
                                isLettingsEdit = true;
                                isLettingsOnly = true;
                                getAvailability()
                              "
                              data-cy="openAvailabilityLettings"
                            >
                              Edit
                            </button>
                          </fieldset>
                          <ng-template pTemplate="footer">
                            <div *ngIf="getTimeSalesValuationDate != getTimeLettingsValuationDate">
                              <fieldset [attr.disabled]="!(isNewValuation && canBookAppointment)">
                                <label>Are we meeting the Owner ?</label>
                                <span class="radio radio--inline">
                                  <span>
                                    <input
                                      class="p-2"
                                      type="radio"
                                      id="lettingsMeetingOwnerYes"
                                      [value]="true"
                                      name="lettingsMeetingOwner"
                                      formControlName="lettingsMeetingOwner"
                                      data-cy="lettingsMeetingOwner"
                                    />
                                    <label for="lettingsMeetingOwnerYes">Yes</label>
                                  </span>
                                  <span>
                                    <input
                                      class="p-2"
                                      type="radio"
                                      id="lettingsMeetingOwnerNo"
                                      [value]="false"
                                      name="lettingsMeetingOwner"
                                      formControlName="lettingsMeetingOwner"
                                    />
                                    <label for="lettingsMeetingOwnerNo">No</label>
                                  </span>
                                </span>
                              </fieldset>
                              <div *ngIf="valuationForm.get('lettingsMeetingOwner').value === false">
                                <span class="inline-parent inline-parent__hasLabels">
                                  <fieldset
                                    class="inline-child"
                                    [ngClass]="{ invalid: formErrors?.lettingsOwnerAssociateName }"
                                  >
                                    <label for="lettingsOwnerAssociateName">Name</label>
                                    <input
                                      class="p-2"
                                      type="text"
                                      name="lettingsOwnerAssociateName"
                                      id="lettingsOwnerAssociateName"
                                      formControlName="lettingsOwnerAssociateName"
                                      [ngClass]="{ 'is-invalid': formErrors.lettingsOwnerAssociateName }"
                                    />
                                    <p class="message message--negative">
                                      {{ formErrors?.lettingsOwnerAssociateName }}
                                    </p>
                                  </fieldset>
                                  <fieldset
                                    class="inline-child"
                                    [ngClass]="{ invalid: formErrors?.lettingsOwnerAssociateContactNumber }"
                                  >
                                    <label for="lettingsOwnerAssociateContactNumber">Contact Number</label>
                                    <input
                                      class="p-2"
                                      type="text"
                                      name="lettingsOwnerAssociateContactNumber"
                                      id="lettingsOwnerAssociateContactNumber"
                                      formControlName="lettingsOwnerAssociateContactNumber"
                                      [ngClass]="{ 'is-invalid': formErrors.lettingsOwnerAssociateContactNumber }"
                                    />
                                    <p class="message message--negative">
                                      {{ formErrors?.lettingsOwnerAssociateContactNumber }}
                                    </p>
                                  </fieldset>
                                </span>
                                <span class="inline-parent inline-parent__hasLabels">
                                  <fieldset
                                    class="inline-child"
                                    [ngClass]="{ invalid: formErrors?.lettingsOwnerAssociateEmail }"
                                  >
                                    <label for="lettingsOwnerAssociateEmail">Email Address</label>
                                    <input
                                      class="p-2"
                                      type="email"
                                      name="lettingsOwnerAssociateEmail"
                                      id="lettingsOwnerAssociateEmail"
                                      formControlName="lettingsOwnerAssociateEmail"
                                      [ngClass]="{ 'is-invalid': formErrors.lettingsOwnerAssociateEmail }"
                                    />
                                    <p class="message message--negative">
                                      {{ formErrors?.lettingsOwnerAssociateEmail }}
                                    </p>
                                  </fieldset>

                                  <fieldset class="inline-child">
                                    <label for="lettingsOwnerAssociateType">Association</label>
                                    <span class="select">
                                      <select
                                        id="lettingsOwnerAssociateType"
                                        formControlName="lettingsOwnerAssociateType"
                                      >
                                        <option
                                          selected
                                          *ngFor="let associateType of associateTypes"
                                          [value]="associateType?.id"
                                        >
                                          {{ associateType?.value }}
                                        </option>
                                      </select>
                                    </span>
                                    <p class="message message--negative">
                                      {{ formErrors?.lettingsOwnerAssociateType }}
                                    </p>
                                  </fieldset>
                                </span>
                              </div>
                            </div>
                          </ng-template>
                        </p-card>
                      </fieldset>
                    </div>

                    <div
                      class="max-w-4xl"
                      *ngIf="
                        getTimeSalesValuationDate &&
                        getTimeLettingsValuationDate &&
                        getTimeSalesValuationDate === getTimeLettingsValuationDate
                      "
                    >
                      <div class="grid justify-center col-auto">
                        <div class="grid justify-center">
                          <fieldset [attr.disabled]="!(isNewValuation && canBookAppointment)">
                            <label>Are we meeting the Owner ?</label>
                            <span class="radio radio--inline">
                              <span>
                                <input
                                  class="p-2"
                                  type="radio"
                                  id="salesMeetingOwnerYes"
                                  [value]="true"
                                  name="salesMeetingOwner"
                                  formControlName="salesMeetingOwner"
                                  data-cy="salesMeetingOwner"
                                />
                                <label for="salesMeetingOwnerYes">Yes</label>
                              </span>
                              <span>
                                <input
                                  class="p-2"
                                  type="radio"
                                  id="salesMeetingOwnerNo"
                                  [value]="false"
                                  name="salesMeetingOwner"
                                  formControlName="salesMeetingOwner"
                                />
                                <label for="salesMeetingOwnerNo">No</label>
                              </span>
                            </span>
                          </fieldset>
                        </div>
                        <div *ngIf="valuationForm.get('salesMeetingOwner').value === false">
                          <span class="inline-parent inline-parent__hasLabels">
                            <fieldset class="inline-child" [ngClass]="{ invalid: formErrors?.salesOwnerAssociateName }">
                              <label for="salesOwnerAssociateName">Name</label>
                              <input
                                class="p-2"
                                type="text"
                                name="salesOwnerAssociateName"
                                id="salesOwnerAssociateName"
                                formControlName="salesOwnerAssociateName"
                                [ngClass]="{ 'is-invalid': formErrors.salesOwnerAssociateName }"
                              />
                              <p class="message message--negative">{{ formErrors?.salesOwnerAssociateName }}</p>
                            </fieldset>
                            <fieldset
                              class="inline-child"
                              [ngClass]="{ invalid: formErrors?.salesOwnerAssociateContactNumber }"
                            >
                              <label for="salesOwnerAssociateContactNumber">Contact Number</label>
                              <input
                                class="p-2"
                                type="text"
                                pattern="[0-9*#+]+$"
                                name="salesOwnerAssociateContactNumber"
                                id="salesOwnerAssociateContactNumber"
                                formControlName="salesOwnerAssociateContactNumber"
                                [ngClass]="{ 'is-invalid': formErrors.salesOwnerAssociateContactNumber }"
                              />
                              <p class="message message--negative">
                                {{ formErrors?.salesOwnerAssociateContactNumber }}
                              </p>
                            </fieldset>
                          </span>
                          <span class="inline-parent inline-parent__hasLabels">
                            <fieldset
                              class="inline-child"
                              [ngClass]="{ invalid: formErrors?.salesOwnerAssociateEmail }"
                            >
                              <label for="salesOwnerAssociateEmail">Email Address</label>
                              <input
                                class="p-2"
                                type="email"
                                name="salesOwnerAssociateEmail"
                                id="salesOwnerAssociateEmail"
                                formControlName="salesOwnerAssociateEmail"
                                [ngClass]="{ 'is-invalid': formErrors.salesOwnerAssociateEmail }"
                              />
                              <p class="message message--negative">{{ formErrors?.salesOwnerAssociateEmail }}</p>
                            </fieldset>

                            <fieldset class="inline-child">
                              <label for="salesOwnerAssociateType">Association</label>
                              <span class="select">
                                <select id="salesOwnerAssociateType" formControlName="salesOwnerAssociateType">
                                  <option
                                    selected
                                    *ngFor="let associateType of associateTypes"
                                    [value]="associateType?.id"
                                  >
                                    {{ associateType?.value }}
                                  </option>
                                </select>
                              </span>
                              <p class="message message--negative">{{ formErrors?.salesOwnerAssociateType }}</p>
                            </fieldset>
                          </span>
                        </div>
                      </div>
                    </div>
                  </div>
                </p-accordionTab>

                <p-accordionTab
                  header="Values"
                  [(selected)]="activeState[3]"
                  *ngIf="areValuesVisible"
                  data-cy="valuationValues"
                >
                  <div class="w-full flex flex-row">
                    <span class="flex-1"></span>
                    <ng-container *ngIf="isAllowedForValueChanges">
                      <app-menu [menuItems]="valueMenuItems"></app-menu>
                    </ng-container>
                  </div>
                  <div
                    id="valuesTab"
                    [ngClass]="{ 'opacity-75 pointer-events-none': isCancelled }"
                    (click)="controlIsCancelled($event, isCancelled)"
                  >
                    <ol class="mb-4 cards" [ngStyle]="{ 'grid-gap': !isEditable && !isNewValuation ? '30px' : '' }">
                      <li
                        *ngIf="
                          (valuation?.salesValuationBooking && isEditable) ||
                          isNewValuation ||
                          (!isEditable && valuationForm.get('suggestedAskingPrice').value)
                        "
                      >
                        <h5 class="txt--title">Sales</h5>
                        <div class="flex flex-row">
                          <fieldset class="mb-3">
                            <label for="sellValue">Value</label>
                            <input
                              class="p-2"
                              type="text"
                              autocomplete="off"
                              name="sellValue"
                              id="sellValue"
                              formControlName="suggestedAskingPrice"
                              *ngIf="!(!isEditable && !isNewValuation) || isEditValueActive"
                              data-cy="sellValue"
                            />
                            <strong class="text-lg" *ngIf="!isEditable && !isNewValuation && !isEditValueActive">
                              {{ valuationForm.get('suggestedAskingPrice').value }}
                            </strong>
                          </fieldset>
                          <fieldset class="ml-14" *ngIf="!isEditable && !isNewValuation && !isEditValueActive">
                            <label style="width: max-content" for="sellValue">Age of valuation</label>
                            <strong
                              class="text-lg"
                              [ngStyle]="{ color: ageColor(valuationForm.get('ageOfSuggestedAskingPrice').value) }"
                            >
                              {{ valuationForm.get('ageOfSuggestedAskingPrice').value + ' months' }}
                            </strong>
                          </fieldset>
                        </div>
                      </li>
                      <li
                        *ngIf="
                          (valuation?.lettingsValuationBooking && isEditable) ||
                          isNewValuation ||
                          (!isEditable && valuationForm.get('suggestedAskingRentLongLet').value)
                        "
                      >
                        <h5 class="txt--title">Long Let</h5>
                        <div class="flex flex-row">
                          <fieldset class="mb-3">
                            <label style="width: max-content" for="longLetValue">Value (per week)</label>
                            <input
                              class="p-2"
                              autocomplete="off"
                              type="text"
                              name="longLetValue"
                              id="longLetValue"
                              formControlName="suggestedAskingRentLongLet"
                              *ngIf="!(!isEditable && !isNewValuation) || isEditValueActive"
                              data-cy="longLetValue"
                            />
                            <strong class="text-lg" *ngIf="!isEditable && !isNewValuation && !isEditValueActive">
                              {{ valuationForm.get('suggestedAskingRentLongLet').value }}
                            </strong>
                          </fieldset>

                          <fieldset
                            class="ml-14"
                            *ngIf="
                              !isEditable &&
                              !isNewValuation &&
                              !valuationForm.get('suggestedAskingRentShortLet').value &&
                              !isEditValueActive
                            "
                          >
                            <label style="width: max-content" for="sellValue">Age of valuation</label>
                            <strong
                              class="text-lg"
                              [ngStyle]="{ color: ageColor(valuationForm.get('ageOfSuggestedAskingPrice').value) }"
                            >
                              {{ valuationForm.get('ageOfSuggestedAskingPrice').value + ' months' }}
                            </strong>
                          </fieldset>
                        </div>
                        <div class="flex flex-row">
                          <fieldset>
                            <label for="longLetMonthlyValue">Value (per month)</label>
                            <input
                              class="p-2"
                              type="text"
                              autocomplete="off"
                              name="longLetMonthlyValue"
                              id="longLetMonthlyValue"
                              formControlName="suggestedAskingRentLongLetMonthly"
                              *ngIf="!(!isEditable && !isNewValuation) || isEditValueActive"
                              data-cy="longLetMonthlyValue"
                            />
                            <strong class="text-lg" *ngIf="!isEditable && !isNewValuation && !isEditValueActive">
                              {{ valuationForm.get('suggestedAskingRentLongLetMonthly').value }}
                            </strong>
                          </fieldset>
                        </div>
                      </li>
                      <li
                        *ngIf="
                          (valuation?.lettingsValuationBooking && isEditable) ||
                          isNewValuation ||
                          (!isEditable && valuationForm.get('suggestedAskingRentShortLet').value)
                        "
                      >
                        <h5 class="txt--title">Short Let</h5>
                        <div class="flex flex-row">
                          <fieldset class="mb-3">
                            <label style="width: max-content" for="shortLetValue">Value (per week)</label>
                            <input
                              class="p-2"
                              autocomplete="off"
                              type="text"
                              name="shortLetValue"
                              id="shortLetValue"
                              formControlName="suggestedAskingRentShortLet"
                              *ngIf="!(!isEditable && !isNewValuation) || isEditValueActive"
                              data-cy="shortLetValue"
                            />
                            <strong class="text-lg" *ngIf="!isEditable && !isNewValuation && !isEditValueActive">
                              {{ valuationForm.get('suggestedAskingRentShortLet').value }}
                            </strong>
                          </fieldset>
                          <fieldset class="ml-14" *ngIf="!isEditable && !isNewValuation && !isEditValueActive">
                            <label style="width: max-content" for="sellValue">Age of valuation</label>
                            <strong
                              class="text-lg"
                              [ngStyle]="{ color: ageColor(valuationForm.get('ageOfSuggestedAskingPrice').value) }"
                            >
                              {{ valuationForm.get('ageOfSuggestedAskingPrice').value + ' months' }}
                            </strong>
                          </fieldset>
                        </div>
                        <div class="flex flex-row">
                          <fieldset>
                            <label for="shortLetMonthlyValue">Value (per month)</label>
                            <input
                              class="p-2"
                              autocomplete="off"
                              type="text"
                              name="shortLetMonthlyValue"
                              id="shortLetMonthlyValue"
                              formControlName="suggestedAskingRentShortLetMonthly"
                              *ngIf="!(!isEditable && !isNewValuation) || isEditValueActive"
                              data-cy="shortLetMonthlyValue"
                            />
                            <strong class="text-lg" *ngIf="!isEditable && !isNewValuation && !isEditValueActive">
                              {{ valuationForm.get('suggestedAskingRentShortLetMonthly').value }}
                            </strong>
                          </fieldset>
                        </div>
                      </li>
                    </ol>
                    <div
                      class="w-auto md:w-8/12"
                      *ngIf="valuation?.salesValuationBooking || valuation?.lettingsValuationBooking"
                    >
                      <fieldset class="mb-3 inline-child" [ngClass]="{ invalid: formErrors?.valuationNote }">
                        <label for="valuationNote">Valuation Meeting Notes</label>
                        <textarea
                          [attr.disabled]="
                            !(
                              valuation?.valuationStatus == 0 ||
                              valuation?.valuationStatus == 1 ||
                              valuation?.valuationStatus == 2
                            ) && !isStillInOneMonthPeriod
                              ? true
                              : null
                          "
                          class="p-2"
                          name="valuationNote"
                          id="valuationNote"
                          cols="30"
                          rows="3"
                          formControlName="valuationNote"
                          data-cy="valuationNote"
                          [ngClass]="{ 'is-invalid': formErrors?.valuationNote }"
                        ></textarea>
                        <p class="message message--negative">{{ formErrors?.valuationNote }}</p>
                      </fieldset>
                    </div>
                  </div>
                </p-accordionTab>

                <p-accordionTab
                  header="Terms Of Business"
                  *ngIf="isTermsOfBusinessVisible"
                  [(selected)]="activeState[4]"
                  data-cy="termsOfBusiness"
                >
                  <div
                    id="termsOfBusinessTab"
                    [ngClass]="{ 'opacity-75 pointer-events-none': isCancelled || isTermsOfBusinessDisabled }"
                    (click)="controlIsCancelled($event, isCancelled || isTermsOfBusinessDisabled)"
                  >
                    <app-terms-of-business
                      [valuationForm]="valuationForm"
                      [interestList]="interestList"
                      [valuationFiles]="valuation.valuationFiles"
                      [formErrors]="formErrors"
                      [tableType]="valuation.valuationType"
                      [valuationStatus]="valuation.valuationStatus"
                      [dateRequestSent]="valuation.dateRequestSent"
                    ></app-terms-of-business>
                  </div>
                </p-accordionTab>

                <p-accordionTab
                  class="landRegister"
                  *ngIf="isLandRegisterVisible"
                  header="Land Register"
                  [(selected)]="activeState[5]"
                >
                  <div
                    id="landRegisterTab"
                    [ngClass]="{ 'opacity-75 pointer-events-none': isCancelled }"
                    (click)="controlIsCancelled($event, isCancelled)"
                  >
                    <app-valuation-land-register
                      [showLeaseExpiryDate]="showLeaseExpiryDate"
                      [valuation]="valuation"
                      [property]="valuation?.property"
                      (afterFileOperation)="scrollSpecificElement('landRegisterTab')"
                    ></app-valuation-land-register>
                  </div>
                </p-accordionTab>

                <p-accordionTab header="Compliance Checks" *ngIf="isLandRegisterVisible" [(selected)]="activeState[6]">
                  <div
                    id="complianceChecksTab"
                    [ngClass]="{ 'opacity-75 pointer-events-none': isCancelled }"
                    (click)="controlIsCancelled($event, isCancelled)"
                  >
                  <!-- <pre>
                    {{}}
                  </pre> -->
                    <app-compliance-checks-shell></app-compliance-checks-shell>
                  </div>
                </p-accordionTab>

                <!-- <p-accordionTab header="Status" [(selected)]="activeState[7]"></p-accordionTab>

                <p-accordionTab header="Instruct" [(selected)]="activeState[8]"></p-accordionTab> -->
              </div>
            </p-accordion>
          </ng-container>

          <fieldset class="mb-3">
            <div class="row" *ngIf="isClientService">
              <div class="col-sm-8 col-xl-6 offset-sm-2">
                <label for="originId" class="small">Vendor Origin</label>
                <div class="row form-group">
                  <div class="col-sm" *ngIf="isEditable || isNewValuation">
                    <select
                      class="custom-select custom-select-sm"
                      name="originTypes"
                      id="originTypes"
                      formControlName="originType"
                      arial-label="Origin Types"
                      (change)="onSelectType($event.target.value)"
                      [ngClass]="{ 'is-invalid': formErrors.originType }"
                    >
                      <option selected value="0">Not Known</option>
                      <option *ngFor="let type of activeOriginTypes" [value]="type.id">{{ type.value }}</option>
                    </select>
                    {{ formErrors?.originType }}
                  </div>
                  <ng-container *ngIf="showOriginId; else originValue">
                    <div class="col-sm">
                      <select
                        class="custom-select custom-select-sm"
                        name="originId"
                        id="originId"
                        formControlName="originId"
                        aria-label="Origins"
                        [ngClass]="{ 'is-invalid': formErrors.originId }"
                      >
                        <option value="0">Not Known</option>
                        <option *ngFor="let origin of origins" [value]="origin.id">{{ origin.value }}</option>
                      </select>
                      {{ formErrors?.originId }}
                    </div>
                  </ng-container>
                  <ng-template #originValue>
                    <div class="col-sm form-group" *ngIf="(!isEditable && origins) || isOriginUnknown">
                      <small>{{ origin }}</small>
                    </div>
                  </ng-template>
                </div>
              </div>
            </div>
          </fieldset>

          <ng-container *ngIf="property">
            <footer class="footer">
              <button (click)="cancel()" type="button" class="btn btn--ghost" data-cy="cancelVal">Cancel</button>
              <button
                *ngIf="canSaveValuation"
                (click)="saveValuation()"
                class="btn btn--positive"
                id="saveVal"
                data-cy="saveVal"
                [disabled]="isSubmitting ? '' : null"
              >
                <svg aria-hidden="true" width="64" height="64" viewBox="0 0 64 64" class="loading" *ngIf="isSubmitting">
                  <path
                    d="M11.9 48.4c-4.1-5-6.3-11.5-5.8-18.6C7.1 17.6 16.8 7.5 29 6.2 44.7 4.4 58 16.7 58 32c0 6.2-2.2 11.8-5.8 16.3 -1 1.2-0.8 2.9 0.3 4l0 0c1.3 1.3 3.4 1.1 4.5-0.3 4.8-6 7.5-13.8 7-22.2C62.9 14 50.1 1.2 34.3 0.1 15.6-1.2 0 13.6 0 32c0 7.7 2.7 14.8 7.3 20.3 1.1 1.3 3 1.4 4.2 0.2l0.2-0.2C12.8 51.2 12.8 49.6 11.9 48.4z"
                  ></path>
                </svg>
                Save Valuation
              </button>
              <button
                *ngIf="canInstruct"
                type="button"
                class="btn btn--positive"
                (click)="startInstruction()"
                data-cy="startInstruction"
              >
                Instruct
              </button>
            </footer>
          </ng-container>
        </form>
      </div>
    </div>
    <ng-container [ngSwitch]="moreInfo">
      <div class="mt-6 mr-10 md:mr-0">
        <app-notes
          *ngSwitchCase="'notes'"
          [noteData]="dataNote"
          [contactGroupNotes]="dataNote?.notes"
          [pageNumber]="page"
          [bottomReached]="bottomReached"
          (showMyNotes)="setShowMyNotesFlag($event)"
        ></app-notes>
      </div>
    </ng-container>
  </div>
</div>

<!-- Property Photos Modal -->
<app-property-detail-photos
  [propertyId]="property?.propertyId"
  [showPhotos]="showPhotos"
  *ngIf="showPhotos"
  (photosClosed)="hidePhotosModal()"
></app-property-detail-photos>

<!-- Property Map Modal -->
<app-property-detail-map
  [propertyMap]="property?.map"
  [showMap]="showMap"
  (mapClosed)="showMap = false"
></app-property-detail-map>

<!-- Contactgroup Finder Modal -->
<p-dialog
  header="Last known owner"
  [(visible)]="isLastKnownOwnerVisible"
  [modal]="true"
  [draggable]="false"
  class="modal--medium modal--hasFooter"
>
  <app-contact-group-finder
    (selectedContactGroup)="getSelectedOwner($event)"
    [showCreateNewCompanyContact]="true"
    (isCreatingNewGroup)="createNewLastKnownOwner()"
  ></app-contact-group-finder>
</p-dialog>

<!-- Contactgroup Finder for admin contact Modal -->
<p-dialog
  header="Admin Contact"
  [(visible)]="isAdminContactVisible"
  [modal]="true"
  [draggable]="false"
  class="modal--medium modal--hasFooter"
>
  <app-contact-group-finder
    [showCreateNewCompanyContact]="true"
    [isSinglePerson]="true"
    (selectedContactGroup)="getSelectedAdminContact($event)"
  ></app-contact-group-finder>
</p-dialog>

<!-- Cancel valuation Modal -->
<p-dialog
  header="Cancel Valuation"
  [(visible)]="isCancelValuationVisible"
  [modal]="true"
  [draggable]="false"
  class="modal--small modal--hasFooter"
>
  <app-cancel-valuation
    [valuationEventId]="valuation?.valuationEventId"
    (cancelOperationFinished)="routeToValuationList()"
  ></app-cancel-valuation>
</p-dialog>

<!-- Property Finder Modal -->
<p-dialog
  header="Find Property"
  [(visible)]="showProperty"
  [modal]="true"
  [draggable]="false"
  class="modal--medium"
  (onHide)="onClosePropertyFinder()"
>
  <app-property-finder
    [property]="property"
    [readOnly]="!isEditable && !isNewValuation"
    [includePhoto]="true"
    [includeMap]="true"
    (selectedProperty)="getSelectedProperty($event)"
    (isCreatingNewProperty)="createNewProperty($event)"
  ></app-property-finder>
</p-dialog>

<!-- for active valuations -->
<p-dialog
  header="Active Valuations"
  [closable]="false"
  [(visible)]="isActiveValuationsVisible"
  [modal]="true"
  [draggable]="false"
  class="modal--medium"
>
  <p-messages severity="warn">
    <ng-template pTemplate>
      <div data-cy="activeValuationMessage">
        There are active valuations on this property, you can continue with one from the list below or create a new one
      </div>
    </ng-template>
  </p-messages>

  <p-table
    [value]="activeValuations"
    selectionMode="single"
    (onRowSelect)="onSelectActiveValuation($event)"
    dataKey="ValuationEventId"
  >
    <ng-template pTemplate="header">
      <tr>
        <th>Status</th>
        <th>Valuation Date</th>
        <th>Valuer</th>
        <th>Sale</th>
        <th>Long Let</th>
        <th>Short Let</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-valuation>
      <tr [pSelectableRow]="valuation">
        <td>
          <ng-container *ngIf="valuation?.valuationStatus; else noValue">
            {{ valuation?.valuationStatusDescription }}
          </ng-container>
        </td>
        <td>
          <span>{{ (valuation?.valuationDate | date: 'dd/MM/yyyy') || '-' }}</span>
        </td>
        <td>
          <span *ngIf="valuation?.salesValuer">
            {{ valuation?.salesValuer?.fullName }}
            <small *ngIf="valuation.salesValuer && valuation.lettingsValuer">,</small>
          </span>
          <span *ngIf="valuation?.lettingsValuer">{{ valuation.lettingsValuer?.fullName }}</span>
        </td>
        <td>
          <ng-container *ngIf="valuation?.suggestedAskingPrice; else noValue">
            {{ valuation?.suggestedAskingPrice | currency: 'GBP':'symbol':'1.0-0' }}
          </ng-container>
        </td>
        <td>
          <ng-container *ngIf="valuation?.suggestedAskingRentLongLet; else noValue">
            {{ valuation?.suggestedAskingRentLongLet | currency: 'GBP':'symbol':'1.0-0' }} pw
          </ng-container>
        </td>
        <td>
          <ng-container *ngIf="valuation?.suggestedAskingRentShortLet; else noValue">
            {{ valuation?.suggestedAskingRentShortLet | currency: 'GBP':'symbol':'1.0-0' }} pw
          </ng-container>
        </td>
      </tr>
    </ng-template>
  </p-table>
  <ng-template #noValue>-</ng-template>

  <footer class="footer--modal">
    <div class="btn--container">
      <button type="submit" class="btn btn--info" data-cy="createValuation" (click)="createNewValuation()">
        Create New Valuation
      </button>
    </div>
  </footer>
</p-dialog>

<!-- Appointment Modal -->
<p-dialog
  #availabilityDialog
  (onHide)="hideAppointmentDialog()"
  [(visible)]="isAppointmentVisible"
  [modal]="true"
  [draggable]="false"
  class="modal--xlarge"
  [closable]="false"
>
  <p-header class="row">
    <span class="mt-auto w-96">Pick availability</span>

    <span class="pt-4 md:pt-0 checkbox w-96" *ngIf="isSalesAndLettings">
      <span class="text-sm">
        <input
          type="checkbox"
          id="splitAppointment"
          name="splitAppointment"
          [(ngModel)]="isSplitAppointment"
          (change)="onSplitAppointmentChange($event.target)"
          data-cy="splitAppointment"
        />
        <label style="font-weight: bolder" for="splitAppointment">Split Appointment</label>
      </span>
    </span>

    <span class="md:mt-auto w-96" *ngIf="!isLettingsOnly && salesValuer">
      <div class="flex pt-3 md:pt-0">
        <div class="flex-initial pr-2 badges" style="font-size: xx-large">
          <p-badge severity="info"></p-badge>
        </div>
        <span class="flex-initial mt-auto text-sm">{{ salesValuer?.fullName }}</span>
      </div>
    </span>

    <span class="mt-auto w-96" *ngIf="!isSalesOnly && salesValuer?.staffMemberId != lettingsValuer?.staffMemberId">
      <div class="flex pt-3 md:pt-0">
        <div class="flex-initial pr-2 badges" style="font-size: xx-large">
          <p-badge severity="success"></p-badge>
        </div>
        <span class="flex-initial mt-auto text-sm">{{ lettingsValuer?.fullName }}</span>
      </div>
    </span>
  </p-header>
  <form [formGroup]="availabilityForm" (ngSubmit)="searchAvailability()">
    <div class="row">
      <div class="grid grid--05">
        <div *ngIf="sideBarControlVisible">
          <p-sidebar [modal]="false" [visible]="sideBarControlVisible" position="left" [showCloseIcon]="false">
            <fieldset class="mb-3">
              <span class="radio radio--boxed" btnRadioGroup formControlName="type">
                <span *ngIf="isBothEdit">
                  <input
                    class="p-2"
                    type="radio"
                    [checked]="availabilityForm.controls['type'].value === 'both' ? 'checked' : ''"
                    tabindex="1"
                    name="valuationBoth"
                    id="valuationBoth"
                  />
                  <label for="valuationBoth" data-cy="valBoth" btnRadio="both" tabindex="0" role="button">
                    <span>Both</span>
                  </label>
                </span>
                <span *ngIf="isBothEdit || isSalesEdit">
                  <input
                    class="p-2"
                    [checked]="availabilityForm.controls['type'].value === 'sales' ? 'checked' : ''"
                    type="radio"
                    tabindex="2"
                    name="appointments"
                    id="valuationSales"
                  />
                  <label for="valuationSales" data-cy="valSales" btnRadio="sales" tabindex="0" role="button">
                    <span>Sales</span>
                  </label>
                </span>
                <span *ngIf="isBothEdit || isLettingsEdit">
                  <input
                    class="p-2"
                    [checked]="availabilityForm.controls['type'].value === 'lettings' ? 'checked' : ''"
                    type="radio"
                    tabindex="2"
                    name="appointments"
                    id="valuationLettings"
                  />
                  <label for="valuationLettings" data-cy="valLet" btnRadio="lettings" tabindex="0" role="button">
                    <span>Lettings</span>
                  </label>
                </span>
              </span>
            </fieldset>

            <span *ngIf="isSalesOnly || isSalesAndLettings" class="inline-parent">
              <fieldset class="md:w-screen" [ngClass]="{ invalid: formErrors?.salesValuerId }">
                <label for="salesValuer">Sales Valuer</label>
                <ng-select
                  [ngClass]="{ invalid: formErrors?.salesValuerId }"
                  placeholder="Select Valuer"
                  [items]="salesValuers"
                  bindLabel="fullName"
                  bindValue="staffMemberId"
                  groupBy="staffMembers"
                  [multiple]="false"
                  formControlName="salesValuerId"
                  (change)="onSalesValuerChange($event)"
                  [readonly]="!isEditable && !isNewValuation"
                  [ngClass]="{ 'is-invalid': formErrors.salesValuerId }"
                  data-cy="salesValuers"
                >
                  <ng-template ng-optgroup-tmp let-item="item">
                    {{ item.office?.name }}
                  </ng-template>
                  <ng-template ng-option-tmp let-item="item">
                    {{ item.fullName }}
                  </ng-template>
                </ng-select>
                <p class="message message--negative">{{ formErrors?.salesValuerId }}</p>
              </fieldset>
              <div class="badges">
                <p-badge severity="info"></p-badge>
              </div>
            </span>

            <span class="inline-parent" *ngIf="isLettingsOnly || isSalesAndLettings">
              <fieldset [ngClass]="{ invalid: formErrors?.lettingsValuerId }" class="md:w-screen">
                <label for="lettingsValuer">Lettings Valuer</label>
                <ng-select
                  [ngClass]="{ invalid: formErrors?.lettingsValuerId }"
                  placeholder="Select Valuer"
                  [items]="lettingsValuers"
                  bindLabel="fullName"
                  bindValue="staffMemberId"
                  groupBy="staffMembers"
                  [multiple]="false"
                  formControlName="lettingsValuerId"
                  (change)="onLettingsValuerChange($event)"
                  [readonly]="!isEditable && !isNewValuation"
                  [ngClass]="{ 'is-invalid': formErrors.lettingsValuerId }"
                  data-cy="lettingsValuer"
                >
                  <ng-template ng-optgroup-tmp let-item="item">
                    {{ item.office?.name }}
                  </ng-template>
                  <ng-template ng-option-tmp let-item="item">
                    {{ item.fullName }}
                  </ng-template>
                </ng-select>
                <p class="message message--negative">{{ formErrors?.lettingsValuerId }}</p>
              </fieldset>
              <div class="badges">
                <p-badge severity="success"></p-badge>
              </div>
            </span>

            <fieldset class="mb-3" [ngClass]="{ invalid: formErrors?.fromDate }">
              <label for="fromDate">Date From</label>
              <input
                class="p-2"
                type="text"
                id="date"
                placeholder="dd/mm/yyyy"
                [ngClass]="{ invalid: formErrors?.fromDate }"
                [bsConfig]="{
                  showWeekNumbers: false,
                  dateInputFormat: 'DD/MM/YYYY',
                  customTodayClass: 'font-weight-bold'
                }"
                bsDatepicker
                formControlName="fromDate"
              />
              <p class="message message--negative">{{ formErrors?.fromDate }}</p>
            </fieldset>

            <fieldset>
              <button class="btn btn--positive" data-cy="searchAvailability">Search</button>
            </fieldset>
          </p-sidebar>
        </div>
        <button type="button" class="btn h-2.5 mb-2 btn--positive" (click)="selectValuersClick()">Valuers</button>
      </div>

      <div class="grid md:h-148 h-96 grid--62 grid--dividerLeft">
        <p-messages *ngIf="isSplitAppointment && !selectedSalesDate" severity="warn">
          <ng-template pTemplate>
            <div data-cy="selectSalesMessage" class="p-ml-2">Please select a slot for sales</div>
          </ng-template>
        </p-messages>
        <p-messages *ngIf="isSplitAppointment && selectedSalesDate && !selectedLettingsDate" severity="warn">
          <ng-template pTemplate>
            <div data-cy="selectLettingsMessage" class="p-ml-2">Please select a slot for lettings</div>
          </ng-template>
        </p-messages>
        <div class="h-148 md:h-5/6">
          <p-scrollPanel [style]="{ width: '100%', height: '80%' }">
            <app-subnav>
              <p class="txt--title" *ngIf="thisWeek">This Week</p>
              <ol class="list list--dates" *ngIf="thisWeek">
                <li *ngFor="let key of thisWeek">
                  <div class="mr-2 min-w-1/4">
                    <app-subnav-item class="underline txt--date" (click)="selectCalendarDate(key['date'])">
                      {{ key['date'] | date: 'EEEE d/M/yy' }}
                    </app-subnav-item>
                  </div>
                  <ol class="cards cards--small">
                    <li *ngFor="let hours of key['hours']">
                      <button
                        type="button"
                        class="btn btn--ghost"
                        [ngClass]="hours.class"
                        (click)="selectAvailableDate(hours); properties = null"
                      >
                        {{ hours.value | date: 'HH:mm' }}
                      </button>
                    </li>
                  </ol>
                </li>
              </ol>

              <p class="txt--title" *ngIf="nextWeek">Next Week</p>
              <ol class="list list--dates" *ngIf="nextWeek">
                <li *ngFor="let key of nextWeek">
                  <div class="mr-2 min-w-1/4">
                    <app-subnav-item class="underline txt--date" (click)="selectCalendarDate(key['date'])">
                      {{ key['date'] | date: 'EEEE d/M/yy' }}
                    </app-subnav-item>
                  </div>
                  <ol class="cards cards--small">
                    <li *ngFor="let hours of key['hours']">
                      <button
                        type="button"
                        class="btn btn--ghost"
                        [ngClass]="hours.class"
                        (click)="selectAvailableDate(hours); properties = null"
                      >
                        {{ hours.value | date: 'HH:mm' }}
                      </button>
                    </li>
                  </ol>
                </li>
              </ol>

              <p class="txt--title" *ngIf="nextWeek">Next Two Week</p>
              <ol class="list list--dates" *ngIf="nextTwoWeek">
                <li *ngFor="let key of nextTwoWeek">
                  <div class="mr-2 min-w-1/4">
                    <app-subnav-item class="underline txt--date" (click)="selectCalendarDate(key['date'])">
                      {{ key['date'] | date: 'EEEE d/M/yy' }}
                    </app-subnav-item>
                  </div>
                  <!-- <span class="txt--date">{{key['date'] | date:'fullDate'}}</span> -->
                  <ol class="cards cards--small">
                    <li *ngFor="let hours of key['hours']">
                      <button
                        type="button"
                        class="btn btn--ghost"
                        [ngClass]="hours.class"
                        (click)="selectAvailableDate(hours); properties = null"
                      >
                        {{ hours.value | date: 'HH:mm' }}
                      </button>
                    </li>
                  </ol>
                </li>
              </ol>
            </app-subnav>
          </p-scrollPanel>
        </div>
      </div>

      <div class="hidden md:block grid--38 grid--dividerLeft" *ngIf="showCalendar">
        <h2 class="mb-2 txt--title">{{ selectedCalendarDate | date: 'fullDate' }}</h2>
        <p-scrollPanel [style]="{ width: '100%', height: '480px' }">
          <app-calendar
            [isOnlyShowPurposes]="true"
            [view]="'day'"
            [viewDate]="selectedCalendarDate"
            [selectedStaffMemberId]="selectedStaffMemberId"
            [secondStaffMemberId]="secondStaffMemberId"
            [tooltipPlacement]="'left'"
          ></app-calendar>
        </p-scrollPanel>
      </div>
    </div>
    <footer class="footer--modal">
      <div class="btn--container">
        <button type="button" class="btn btn--ghost" (click)="cancelBooking()">Cancel</button>
        <button
          type="button"
          class="btn btn--positive"
          [disabled]="sideBarControlVisible"
          data-cy="saveBooking"
          (click)="makeBooking()"
        >
          {{ bookingButtonLabel }}
        </button>
      </div>
    </footer>
  </form>
</p-dialog>

<!-- Instruct Modal -->
<p-dialog
  header="Confirm values and choose instruction type"
  [(visible)]="isInstructVisible"
  [modal]="true"
  [draggable]="false"
  class="modal--medium modal--hasFooter"
>
  <form [formGroup]="instructionForm" (ngSubmit)="saveInstruction()" autocompleteOff>
    <ng-container *ngIf="instruction?.askingPrice">
      <fieldset *ngIf="showInstruct" class="mb-2">
        <span class="checkbox">
          <span>
            <input
              class="p-2"
              type="checkbox"
              id="instructSale"
              name="instructSale"
              formControlName="instructSale"
              data-cy="instructSale"
            />
            <label for="instructSale">Instruct for Sales</label>
          </span>
        </span>
      </fieldset>
      <fieldset class="self-start">
        <p-card [style]="{ width: '20rem', 'margin-bottom': '2em' }">
          <h5 class="mb-4">Sales</h5>
          <fieldset
            [disabled]="!instructionForm.get('instructSale').value ? 'true' : null"
            [ngClass]="{ invalid: formErrors.askingPrice }"
          >
            <label for="askingPrice">Value</label>
            <input class="p-2" type="text" name="askingPrice" id="askingPrice" formControlName="askingPrice" />
            <p class="message message--negative">{{ formErrors?.askingPrice }}</p>
          </fieldset>
        </p-card>
      </fieldset>
      <div *ngIf="instructionForm.get('instructSale').value" [style]="{ width: '20rem', 'margin-bottom': '1em' }">
        <fieldset class="mb-4">
          <label>Sales Agency</label>
          <span class="radio radio--inline">
            <span>
              <input
                class="p-2"
                type="radio"
                id="soleAgencySales"
                value="1"
                name="salesAgencyType"
                formControlName="salesAgencyType"
                data-cy="soleAgencySales"
              />
              <label for="soleAgencySales">Sole Agency</label>
            </span>
            <span>
              <input
                class="p-2"
                type="radio"
                id="multiAgencySales"
                value="4"
                name="salesAgencyType"
                formControlName="salesAgencyType"
              />
              <label for="multiAgencySales">Multi Agency</label>
            </span>
          </span>
        </fieldset>
        <p-messages *ngIf="formErrors?.salesAgencyType" severity="warn">
          <ng-template pTemplate>
            <div data-cy="agencyMessage" class="p-ml-2">{{ formErrors?.salesAgencyType }}</div>
          </ng-template>
        </p-messages>
      </div>
    </ng-container>

    <ng-container *ngIf="instruction?.askingRentShortLet || instruction?.askingRentLongLet">
      <fieldset class="mb-2">
        <span class="checkbox">
          <span>
            <input
              class="p-2"
              type="checkbox"
              id="instructLet"
              name="instructLet"
              formControlName="instructLet"
              (change)="onInstructLettingsChange($event.target)"
              data-cy="instructLet"
            />
            <label for="instructLet">Instruct for Lettings</label>
          </span>
        </span>
        <p-messages
          *ngIf="
            instructionForm.get('instructLet').value &&
            !instructionForm.get('isInstructLongLet').value &&
            !instructionForm.get('isInstructShortLet').value
          "
          severity="error"
        >
          <ng-template pTemplate>
            <div data-cy="optionMessage" class="p-ml-2">Please choose an option</div>
          </ng-template>
        </p-messages>
      </fieldset>

      <div class="inline-parent">
        <fieldset class="inline-child">
          <p-card [style]="{ width: '20rem', 'margin-bottom': '1em' }">
            <div>
              <div class="flex flex-row p-field-checkbox" style="margin-bottom: 24px">
                <label for="isInstructLongLet">Long Let</label>
                <p-checkbox
                  [disabled]="!instructionForm.get('instructLet').value"
                  formControlName="isInstructLongLet"
                  data-cy="isInstructLongLet"
                  [binary]="true"
                  inputId="isInstructLongLet"
                ></p-checkbox>
              </div>
              <fieldset
                [disabled]="!instructionForm.get('isInstructLongLet').value ? 'true' : null"
                [ngClass]="{ invalid: formErrors.askingRentLongLet }"
              >
                <label for="longLetValue">Value (per week)</label>
                <input
                  class="p-2"
                  type="text"
                  name="longLetValue"
                  id="longLetValue"
                  formControlName="askingRentLongLet"
                />
                <p class="message message--negative">{{ formErrors?.askingRentLongLet }}</p>
              </fieldset>
              <!-- [ngStyle]="{'background': !instructionForm.get('isInstructLongLet').value?'lightgray':null}" -->
              <fieldset [disabled]="!instructionForm.get('isInstructLongLet').value ? 'true' : null">
                <label for="longLetMonthlyValue">Value (per month)</label>
                <input
                  class="p-2"
                  type="text"
                  name="longLetMonthlyValue"
                  id="longLetMonthlyValue"
                  formControlName="askingRentLongLetMonthly"
                />
              </fieldset>
            </div>
          </p-card>
        </fieldset>
        <fieldset class="inline-child">
          <p-card [style]="{ width: '20rem', 'margin-bottom': '1em' }">
            <div class="flex flex-row p-field-checkbox" style="margin-bottom: 24px">
              <label for="isInstructLongLet">Short Let</label>
              <p-checkbox
                [disabled]="!instructionForm.get('instructLet').value"
                formControlName="isInstructShortLet"
                data-cy="isInstructShortLet"
                [binary]="true"
                inputId="isInstructShortLet"
              ></p-checkbox>
            </div>
            <fieldset
              [ngClass]="{ invalid: formErrors.askingRentShortLet }"
              [disabled]="!instructionForm.get('isInstructShortLet').value ? 'true' : null"
            >
              <label for="shortLetValue">Value (per week)</label>
              <input
                class="p-2"
                type="text"
                name="shortLetValue"
                id="shortLetValue"
                formControlName="askingRentShortLet"
              />
              <p class="message message--negative">{{ formErrors?.askingRentShortLet }}</p>
            </fieldset>

            <fieldset [disabled]="!instructionForm.get('isInstructShortLet').value ? 'true' : null">
              <label for="shortLetMonthlyValue">Value (per month)</label>
              <input
                class="p-2"
                type="text"
                name="shortLetMonthlyValue"
                id="shortLetMonthlyValue"
                formControlName="askingRentShortLetMonthly"
              />
            </fieldset>
          </p-card>
        </fieldset>
      </div>

      <div [style]="{ width: '20rem', 'margin-bottom': '1em' }">
        <fieldset *ngIf="instructionForm.get('instructLet').value">
          <label>Lettings Agency</label>
          <span class="radio radio--inline">
            <span>
              <input
                class="p-2"
                type="radio"
                id="soleAgencyLettings"
                value="1"
                name="lettingsAgencyType"
                formControlName="lettingsAgencyType"
                data-cy="soleAgencyLettings"
              />
              <label for="soleAgencyLettings">Sole Agency</label>
            </span>
            <span>
              <input
                class="p-2"
                type="radio"
                id="multiAgencyLettings"
                value="2"
                name="lettingsAgencyType"
                formControlName="lettingsAgencyType"
                data-cy="multiAgencyLettings"
              />
              <label for="multiAgencyLettings">Multi Agency</label>
            </span>
          </span>
        </fieldset>
        <p-messages *ngIf="formErrors?.lettingsAgencyType" severity="warn">
          <ng-template pTemplate>
            <div data-cy="lettingAgencyMessage" class="p-ml-2">{{ formErrors?.lettingsAgencyType }}</div>
          </ng-template>
        </p-messages>
      </div>
    </ng-container>

    <footer class="footer--modal">
      <div class="btn--container">
        <button type="button" class="btn btn--ghost" (click)="isInstructVisible = false; cancelInstruction()">
          Cancel
        </button>
        <button
          type="submit"
          class="btn btn--positive"
          [disabled]="
            !instructionForm.get('instructLet').value && !instructionForm.get('instructSale').value ? true : null
          "
          data-cy="saveInstruction"
        >
          Instruct
        </button>
      </div>
    </footer>
  </form>
</p-dialog>
<!--Success Messages -->
<p-toast></p-toast>
