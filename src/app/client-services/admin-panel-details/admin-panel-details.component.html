<app-breadcrumb></app-breadcrumb>
<div class="container">
    <div class="row page-title">
        <div class="col">
            <h4 class="m-0">Player</h4>
        </div>
    </div>
    <div class="row">
        <div class="col-xl-8">
            <div class="row text-center text-sm-left align-items-center mb-4">
                <div class="col-sm-auto mb-3">
                    <img class="rounded-circle" src="https://dummyimage.com/150x150/e9ecef/212529&text=no+photo" alt="">
                </div>
                <div class="col-sm mb-3">
                    <h5 class="mt-0">Melissa D'Angelo</h5>
                    <dl>
                        <dt>Position</dt>
                        <dd>1 <i class="fas fa-chevron-up fa-lg ml-2 text-success"></i></dd>
                        <dt>Points</dt>
                        <dd>1230</dd>
                    </dl>
                </div>
            </div>
            <div class="row justify-content-between">
                <div class="col col-sm-6">
                    <form [formGroup]="searchForm">
                        <div class="form-group">
                            <select class="custom-select" id="month" aria-label="Month" formControlName="searchTerm">
                                <option value="0" selected>Month</option>
                                <option value="1">June 2020</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="col-auto">
                    <button class="btn btn-primary" (click)="openModal(template)"><i class="fas fa-plus mr-2"></i> Record</button>
                </div>
            </div>


            <table class="table table-striped">
                <thead>
                    <tr>
                        <th scope="col">Date</th>
                        <th scope="col">Reason</th>
                        <th scope="col">Points</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let point of points$|async">
                        <td>{{point?.dateTime|date}}</td>
                        <td>{{point?.reason}}</td>
                        <td>{{point?.points}}</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

<ng-template #template>
    <div class="modal-header">
        <h4 class="modal-title pull-left">New Record</h4>
        <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide(); clearRecordForm()">
        <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">
        <form [formGroup]="recordForm" autocomplete="off" (ngSubmit)="addRecord()">
            <div class="form-group">
                <label for="date">Date</label>
                <input type="text" id="date" placeholder="dd/mm/yyyy" class="form-control" formControlName="recordDate"
                [bsConfig]="{showWeekNumbers:false, dateInputFormat: 'DD/MM/YYYY'}" bsDatepicker [ngClass]="{'is-invalid': formErrors?.recordDate}">
                <div class="invalid-feedback">{{formErrors?.recordDate}}</div>
            </div>
            <div class="form-group">
                <label for="preset">Preset</label>
                <select class="custom-select" id="preset" formControlName="pointType" (change)="populatePointFields($event.target.value)" [ngClass]="{'is-invalid': formErrors?.pointType}">
                    <option value="0" selected>None</option>
                    <option *ngFor="let type of pointTypes" [value]="type?.pointTypeId">{{type?.name}}</option>
                </select>
                <div class="invalid-feedback">{{formErrors?.pointType}}</div>
            </div>
            <div class="form-group">
                <label for="reason">Reason</label>
                <input type="text" id="reason" class="form-control" formControlName="reason" [ngClass]="{'is-invalid': formErrors?.reason}">
                <div class="invalid-feedback">{{formErrors?.reason}}</div>
            </div>
            <div class="form-group">
                <label for="points">Points</label>
                <input type="text" id="points" class="form-control" formControlName="points" [ngClass]="{'is-invalid': formErrors?.points}">
                <div class="invalid-feedback">{{formErrors?.points}}</div>
            </div>
            <button class="btn btn-primary btn-block mt-4" type="submit">Add Record</button>
        </form>
    </div>
</ng-template>
